<html lang="en">

<head>
    <title>Chatalysis - {{ title }}</title>
    <style>
        body {
            font-family: "Georgia", 'Times New Roman', Times, serif
        }
        div.root {
            text-align: center;
            padding: 10px;
        }
        .profile-picture {
            border-radius: 50%;
            object-fit: cover;
            width: 100px;
            height: 100px;
            border: 10px double black;
        }
        .profile-picture-small {
            border-radius: 50%;
            object-fit: cover;
            width: 75px;
            height: 75px;
            border: 5px double black;
        }
        .stats {
            margin-top: 1px;
            margin-bottom: 1px;
        }
        .stats-num {
            margin: 0;
            font-size: 30;
            font-weight: 200;
        }
        .stats-text {
            margin: 0;
        }
        .emojis {
            margin: 0;
            align-self: flex-end;
        }
    </style>
    <script src="/Users/stepan/node_modules/chart.js/dist/Chart.js"></script>
    <meta charset="utf-8">
</head>

<body>
    <div class="root">
        <section id="header">
            <i>Chatalysis {{ version }}</i>
        </section>
        <section id="names" style="display: grid; grid-template-columns: repeat(3, auto);">
            <div style="text-align: right;">
                <img src="{{ picture1 }}" alt="Profile picture 1" class="profile-picture">
            </div>
            <div>
                <h1>{{ fullname1 }} and {{ fullname2 }}</h1>
                <b>{{ fromDay }}</b>   -   <b>{{ toDay }}</b>
            </div> 
            <div style="text-align: left;">
                <img src="{{ picture2 }}" alt="Profile picture 2" class="profile-picture">
            </div>
        </section>
        <section id="total messages" style="padding-top: 10px;">
            <p style="margin: 0; font-size: 50; font-weight: 500;">{{ totalMessages }}</p>
            <p style="margin: 0;">total messages</p>
        </section>
        <section id="total stats" style="display: grid; grid-template-columns: repeat(6, 1fr); padding-top: 10px; padding-bottom: 10px;">
            <div>
                <p class="stats-num">{{ totalImages }}</p>
                <p class="stats-text">{{ "images" if totalImages != 1 else "image"}}</p>
            </div>
            <div>
                <p class="stats-num">{{ totalGifs }}</p>
                <p class="stats-text">{{ "gifs" if totalGifs != 1 else "gif"}}</p>
            </div>
            <div>
                <p class="stats-num">{{ totalStickers }}</p>
                <p class="stats-text">{{ "stickers" if totalStickers != 1 else "sticker"}}</p>
            </div>
            <div>
                <p class="stats-num">{{ totalVideos }}</p>
                <p class="stats-text">{{ "videos" if totalVideos != 1 else "video"}}</p>
            </div>
            <div>
                <p class="stats-num">{{ totalAudios }}</p>
                <p class="stats-text">{{ "audios" if totalAudios != 1 else "audio"}}</p>
            </div>
            <div>
                <p class="stats-num">{{ totalFiles }}</p>
                <p class="stats-text">{{ "files" if totalFiles != 1 else "file"}}</p>
            </div>
        </section>
        <section id="personal stats" style="display: grid; grid-template-columns: 1fr 1fr 200px 1fr 1fr; padding-bottom: 20px; padding-top: 30px; grid-gap: 2px;">
            <div style="display: flex; align-items: center; justify-self: end;">
                <div style="display: grid; grid-template-rows: auto auto; padding-right: 10px; border-right: 1px solid black;">
                    <div>
                    <img src="{{ picture1 }}" alt="Profile picture 1" class="profile-picture-small">
                    </div>
                    <p style="margin-top: 5px; margin-bottom: 0;">
                    <b>{{ name1 }}</b>
                    </p>
                </div>
            </div>
            <div style="display: flex; align-items: center; justify-self: start;">
                <div style="text-align: left; padding-left: 10px; border-left: 1px solid black;">
                    <p class="stats">
                        <b>{{ messages1 }}</b> messages<br>
                        <b>{{ images1 }}</b> {{ "images" if images1 != 1 else "image"}}<br>
                        <b>{{ gifs1 }}</b> {{ "gifs" if gifs1 != 1 else "gif"}}<br>
                        <b>{{ stickers1 }}</b> {{ "stickers" if stickers1 != 1 else "sticker"}}<br>
                        <b>{{ videos1 }}</b> {{ "videos" if videos1 != 1 else "video"}}<br>
                        <b>{{ audios1 }}</b> {{ "audios" if audios1 != 1 else "audio"}}<br>
                        <b>{{ files1 }}</b> {{ "files" if files1 != 1 else "file"}}
                    </p>
                </div>
            </div>
            <div>
                <canvas id="pieMessages" width="200" height="200"></canvas>
            </div>
            <div style="display: flex; align-items: center; justify-self: end;">
                <div style="display: grid; grid-template-rows: auto auto; padding-right: 10px; border-right: 1px solid black;">
                    <div>   
                    <img src="{{ picture2 }}" alt="Profile picture 1" class="profile-picture-small">
                    </div>
                    <p style="margin-bottom: 0; margin-top: 5px;">
                    <b>{{ name2 }}</b>
                    </p>
                </div>
            </div>
            <div style="display: flex; align-items: center; justify-self: start;">
                <div style="text-align: left; padding-left: 10px; border-left: 1px solid black;">
                    <p class="stats">
                        <b>{{ messages2 }}</b> messages<br>
                        <b>{{ images2 }}</b> {{ "images" if images2 != 1 else "image"}}<br>
                        <b>{{ gifs2 }}</b> {{ "gifs" if gifs2 != 1 else "gif"}}<br>
                        <b>{{ stickers2 }}</b> {{ "stickers" if stickers2 != 1 else "sticker"}}<br>
                        <b>{{ videos2 }}</b> {{ "videos" if videos2 != 1 else "video"}}<br>
                        <b>{{ audios2 }}</b> {{ "audios" if audios2 != 1 else "audio"}}<br>
                        <b>{{ files2 }}</b> {{ "files" if files2 != 1 else "file"}}
                    </p>
                </div>
            </div>
        </section>
        <section id="time stats" style="display: grid; grid-template-columns: repeat(4, 1fr); padding-bottom: 20px; padding-top: 20px;">
            <div>
                <p class="stats-num">{{ topDay }}</p>
                <p class="stats-text">top day<br>
                ({{ topDayMsgs }} messages)</p>
            </div>
            <div>
                <p class="stats-num">{{ topMonth }}</p>
                <p class="stats-text">top month<br>
                ({{ topMonthMsgs }})</p>
            </div>
            <div>
                <p class="stats-num">{{ topYear }}</p>
                <p class="stats-text"></p>top year<br>
                ({{ topYearMsgs }})</p>
            </div>
            <div>
                <p class="stats-num">{{ topWeekday }}</p>
                <p class="stats-text">top weekday<br>
                    ({{ topWeekdayMsgs }})</p>
            </div>
        </section>
        <section id="time graphs" style="display: grid; grid-template-columns: 75% 25%; padding-bottom: 20px; padding-top: 20px;" >
            <div style="height: 225px;">
                <canvas id="timeGraph"></canvas>
            </div>
            <div style="height: 225px;">
                <canvas id="hours"></canvas>
            </div>
        </section>
        <section id="emoji stats" style="display: grid; grid-template-columns: 25% 25% 50%; padding-bottom: 20px; padding-top: 30px;">
            <div style="display: flex; align-items: center; justify-content: center;">
                <div>    
                    <p class="stats-num">{{ totalEms }}</p>
                    <p class="stats-text">total emojis<br>
                </div>
            </div>
            <div style="display: flex; align-items: center; justify-content: center;">
                <div>
                    <p class="stats-num">{{ diffEms }}</p>
                    <p class="stats-text">different emojis<br>
                </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat({{emojisL}}, auto);">
                <div style="display: flex; justify-content: center;">
                    <p class="emojis"><span style="font-size: 300%">{{ emojis[0] }}</span><br>
                    {{ "(" if emojisL>0 }}{{ emojisN[0] }}{{ ")" if emojisL>0}}</span></p>
                </div>
                <div style="display: flex; justify-content: center;">
                    <p class="emojis"><span style="font-size: 275%">{{ emojis[1] }}</span><br>
                    {{ "(" if emojisL>1 }}{{ emojisN[1] }}{{ ")" if emojisL>1}}</span></p>
                </div>
                <div style="display: flex; justify-content: center;">
                    <p class="emojis"><span style="font-size: 250%">{{ emojis[2] }}</span><br>
                    {{ "(" if emojisL>2 }}{{ emojisN[2] }}{{ ")" if emojisL>2}}</span></p>
                </div>
                <div style="display: flex; justify-content: center;">
                    <p class="emojis"><span style="font-size: 225%">{{ emojis[3] }}</span><br>
                    {{ "(" if emojisL>3 }}{{ emojisN[3] }}{{ ")" if emojisL>3}}</span></p>
                </div>
                <div style="display: flex; justify-content: center;">
                    <p class="emojis"><span style="font-size: 200%">{{ emojis[4] }}</span><br>
                    {{ "(" if emojisL>4 }}{{ emojisN[4] }}{{ ")" if emojisL>4}}</span></p>
                </div>
                <div style="display: flex; justify-content: center;">
                    <p class="emojis"><span style="font-size: 180%">{{ emojis[5] }}</span><br>
                    {{ "(" if emojisL>5 }}{{ emojisN[5] }}{{ ")" if emojisL>5}}</span></p>
                </div>
                <div style="display: flex; justify-content: center;">
                    <p class="emojis"><span style="font-size: 160%">{{ emojis[6] }}</span><br>
                    {{ "(" if emojisL>6 }}{{ emojisN[6] }}{{ ")" if emojisL>6}}</span></p>
                </div>
                <div style="display: flex; justify-content: center;">
                    <p class="emojis"><span style="font-size: 140%">{{ emojis[7] }}</span><br>
                    {{ "(" if emojisL>7 }}{{ emojisN[7] }}{{ ")" if emojisL>7}}</span></p>
                </div>
                <div style="display: flex; justify-content: center;">
                    <p class="emojis"><span style="font-size: 120%">{{ emojis[8] }}</span><br>
                    {{ "(" if emojisL>8 }}{{ emojisN[8] }}{{ ")" if emojisL>8}}</span></p>
                </div>
                <div style="display: flex; justify-content: center;">
                    <p class="emojis"><span style="font-size: 100%">{{ emojis[9] }}</span><br>
                    {{ "(" if emojisL>9 }}{{ emojisN[9] }}{{ ")" if emojisL>9}}</span></p>
                </div>
            </div>
        </section>
        <section id="emoji personal" style="display: grid; grid-template-columns: 50% 50%; padding-bottom: 20px; padding-top: 10px;">
        </section>
        <section id="footer">
            <i><a style="color: inherit; text-decoration: none;" href="https://github.com/stepva/chatalysis">https://github.com/stepva/chatalysis</a></i>
        </section>
    </div>
    <script>
        var myChart = new Chart("pieMessages", {
            type: 'doughnut',
            data: {
                labels: {{ names|safe }},
                datasets: [{
                    data: {{ msgsPeople|safe }},
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.5)',
                        'rgba(54, 162, 235, 0.5)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                legend: {display: false},
                title: {
                    display: true,
                    text: 'Messages distribution'
                }
            }    
        })
    </script>
    <script>
        var myChart = new Chart("timeGraph", {
                type: "bar",
                data: {
                    labels: {{ daysLab|safe }},
                    datasets: [{
                        maxBarThickness: 2,
                        data: {{ days|safe }},
                        backgroundColor: "rgba(0, 0, 0, 1)",
                        borderColor: "rgba(0, 0, 0, 1)",
                        hoverBackgroundColor: "rgba(0, 0, 0, 1)",
                        hoverBorderColor: "rgba(0, 0, 0, 1)" 
                    }]               
                },
                options: {
                    scales: {
                        xAxes: [{
                            gridLines: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                autoSkipPadding: 50,
                                maxRotation: 0
                            }
                        }],
                            yAxes: [{
                                gridLines: {
                                    drawOnChartArea: false
                                },
                                ticks: {
                                    stepSize: {{ stepSizeY }}
                                }
                            }]
                    },
                    legend: {display: false},
                    title: {
                        display: true,
                        text: "Daily messages over time"
                    },
                    maintainAspectRatio: false,
                    tooltips: {enabled: false},
                    hover: {mode: null}
            }
        })
    </script> 
    <script>
        var myChart = new Chart("hours", {
                type: "line",
                data: {
                    labels: {{ hoursLab| safe }},
                    datasets: [{
                        data: {{ hours| safe }},
                        backgroundColor: "rgba(0, 0, 0, 0.2)",
                        borderColor: "rgba(0, 0, 0, 0.8)",
                        hoverBackgroundColor: "rgba(0, 0, 0, 0.2)",
                        hoverBorderColor: "rgba(0, 0, 0, 0.8)",
                        borderWidth: 2 
                        }]               
                },
                options: {
                    scales: {
                        xAxes: [{
                            gridLines: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                autoSkipPadding: 50,
                                maxRotation: 0
                            }
                        }],
                            yAxes: [{
                                gridLines: {
                                    drawOnChartArea: false,
                                },
                                ticks: {
                                    display: false,
                                    stepSize: {{ stepSizeYh }}
                                }
                            }]
                        },
                    elements: {
                        point: {
                            radius: 0
                        }
                    },        
                    legend: { display: false },
                    title: {
                        display: true,
                        text: "Messages throughout the day"
                        },
                    maintainAspectRatio: false
                    }
                })
    </script>
      
</body>

</html>

