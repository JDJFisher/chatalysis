<html lang="en">

<head>
    <title>Chatalysis - {{ title }}</title>
    <style>
        body {
            font-family: "Georgia", 'Times New Roman', Times, serif
        }
        div.route {
            text-align: center;
            padding: 10px;
        }
        .profile-picture {
            border-radius: 50%;
            object-fit: cover;
            width: 100px;
            height: 100px;
            border: 10px double black;
        }
        .profile-picture-small {
            border-radius: 50%;
            object-fit: cover;
            width: 75px;
            height: 75px;
            border: 5px double black;
        }
        .stats {
            margin-top: 1px;
            margin-bottom: 1px;
        }
        .stats-num {
            margin: 0;
            font-size: 30;
            font-weight: 200;
        }
        .stats-text {
            margin: 0;

        }
    </style>
    <script src="/Users/stepan/node_modules/chart.js/dist/Chart.js"></script>
    <meta charset="utf-8">
</head>

<body>
    <div class="route">
        <section id="header">
            <i>Chatalysis {{ version }}</i>
        </section>
        <section id="names" style="display: grid; grid-template-columns: repeat(3, auto);">
            <div style="text-align: right;">
                <img src="{{ picture1 }}" alt="Profile picture 1" class="profile-picture">
            </div>
            <div>
                <h1>{{ fullname1 }} and {{ fullname2 }}</h1>
                {{ fromDay }} - {{ toDay }}
            </div> 
            <div style="text-align: left;">
                <img src="{{ picture2 }}" alt="Profile picture 2" class="profile-picture">
            </div>
        </section>
        <section id="total messages" style="padding-top: 10px;">
            <p style="margin: 0; font-size: 50; font-weight: 500;">{{ totalMessages }}</p>
            <p style="margin: 0;">total messages</p>
        </section>
        <section id="total stats" style="display: grid; grid-template-columns: repeat(6, 1fr); padding-top: 10px; padding-bottom: 10px;">
            <div>
                <p class="stats-num">{{ totalImages }}</p>
                <p class="stats-text">{{ "images" if totalImages != 1 else "image"}}</p>
            </div>
            <div>
                <p class="stats-num">{{ totalGifs }}</p>
                <p class="stats-text">{{ "gifs" if totalGifs != 1 else "gif"}}</p>
            </div>
            <div>
                <p class="stats-num">{{ totalStickers }}</p>
                <p class="stats-text">{{ "stickers" if totalStickers != 1 else "sticker"}}</p>
            </div>
            <div>
                <p class="stats-num">{{ totalVideos }}</p>
                <p class="stats-text">{{ "videos" if totalVideos != 1 else "video"}}</p>
            </div>
            <div>
                <p class="stats-num">{{ totalAudios }}</p>
                <p class="stats-text">{{ "audios" if totalAudios != 1 else "audio"}}</p>
            </div>
            <div>
                <p class="stats-num">{{ totalFiles }}</p>
                <p class="stats-text">{{ "files" if totalFiles != 1 else "file"}}</p>
            </div>
        </section>
        <section id="personal stats" style="display: grid; grid-template-columns: 1fr 1fr 200px 1fr 1fr; padding-bottom: 20px; padding-top: 30px; grid-gap: 2px;">
            <div style="display: flex; align-items: center; justify-self: end;">
                <div style="display: grid; grid-template-rows: auto auto; padding-right: 10px; border-right: 1px solid black;">
                    <div>
                    <img src="{{ picture1 }}" alt="Profile picture 1" class="profile-picture-small">
                    </div>
                    <p style="margin-top: 5px; margin-bottom: 0;">
                    <b>{{ name1 }}</b>
                    </p>
                </div>
            </div>
            <div style="display: flex; align-items: center; justify-self: start;">
                <div style="text-align: left; padding-left: 10px; border-left: 1px solid black;">
                    <p class="stats">
                        <b>{{ messages1 }}</b> messages<br>
                        <b>{{ images1 }}</b> {{ "images" if images1 != 1 else "image"}}<br>
                        <b>{{ gifs1 }}</b> {{ "gifs" if gifs1 != 1 else "gif"}}<br>
                        <b>{{ stickers1 }}</b> {{ "stickers" if stickers1 != 1 else "sticker"}}<br>
                        <b>{{ videos1 }}</b> {{ "videos" if videos1 != 1 else "video"}}<br>
                        <b>{{ audios1 }}</b> {{ "audios" if audios1 != 1 else "audio"}}<br>
                        <b>{{ files1 }}</b> {{ "files" if files1 != 1 else "file"}}
                    </p>
                </div>
            </div>
            <div>
                <canvas id="pieMessages" width="200" height="200"></canvas>
            </div>
            <div style="display: flex; align-items: center; justify-self: end;">
                <div style="display: grid; grid-template-rows: auto auto; padding-right: 10px; border-right: 1px solid black;">
                    <div>   
                    <img src="{{ picture2 }}" alt="Profile picture 1" class="profile-picture-small">
                    </div>
                    <p style="margin-bottom: 0; margin-top: 5px;">
                    <b>{{ name2 }}</b>
                    </p>
                </div>
            </div>
            <div style="display: flex; align-items: center; justify-self: start;">
                <div style="text-align: left; padding-left: 10px; border-left: 1px solid black;">
                    <p class="stats">
                        <b>{{ messages2 }}</b> messages<br>
                        <b>{{ images2 }}</b> {{ "images" if images2 != 1 else "image"}}<br>
                        <b>{{ gifs2 }}</b> {{ "gifs" if gifs2 != 1 else "gif"}}<br>
                        <b>{{ stickers2 }}</b> {{ "stickers" if stickers2 != 1 else "sticker"}}<br>
                        <b>{{ videos2 }}</b> {{ "videos" if videos2 != 1 else "video"}}<br>
                        <b>{{ audios2 }}</b> {{ "audios" if audios2 != 1 else "audio"}}<br>
                        <b>{{ files2 }}</b> {{ "files" if files2 != 1 else "file"}}
                    </p>
                </div>
            </div>
        </section>
        <section id="time stats" style="display: grid; grid-template-columns: repeat(4, 1fr); padding-bottom: 20px; padding-top: 20px;">
            <div>
                <p class="stats-num">{{ topDay }}</p>
                <p class="stats-text">top day<br>
                ({{ topDayMsgs }} messages)</p>
            </div>
            <div>
                <p class="stats-num">{{ topMonth }}</p>
                <p class="stats-text">top month<br>
                ({{ topMonthMsgs }})</p>
            </div>
            <div>
                <p class="stats-num">{{ topYear }}</p>
                <p class="stats-text"></p>top year<br>
                ({{ topYearMsgs }})</p>
            </div>
            <div>
                <p class="stats-num">{{ topWeekday }}</p>
                <p class="stats-text">top weekday<br>
                    ({{ topWeekdayMsgs }})</p>
            </div>
        </section>
        <section id="time graph">
            <div style="height: 50px;">
                <canvas id="timeGraph" height="50px"></canvas>
            </div>
        </section>
        <!--
        <section id="footer">
            <div>
            <p><i><a style="color: inherit; text-decoration: none;" href="https://github.com/stepva/chatalysis">https://github.com/stepva/chatalysis</a></i></p>
            </div>
        </section>
        -->
    </div>
    <script>
        var myChart = new Chart("pieMessages", {
            type: 'doughnut',
            data: {
                labels: {{ names|safe }},
                datasets: [{
                    data: {{ msgsPeople|safe }},
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.5)',
                        'rgba(54, 162, 235, 0.5)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                legend: {display: false},
                title: {
                    display: true,
                    text: 'Messages distribution'
                }
            }    
        })
    </script>
    <script>
        var myChart2 = new Chart("timeGraph", {
                type: "bar",
                data: {
                    labels: {{ daysLab|safe }},
                    datasets: [{
                        label: "All messages",
                        data: {{ days|safe }},
                        backgroundColor: "rgba(0, 0, 0, 1)",
                        borderColor: "rgba(0, 0, 0, 1)",
                        hoverBackgroundColor: "rgba(0, 0, 0, 1)",
                        hoverBorderColor: "rgba(0, 0, 0, 1)" 
                    }]               
                },
                options: {
                    scales: {
                        xAxes: [{
                            gridLines: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                autoSkipPadding: 50,
                                maxRotation: 0
                            }
                        }],
                            yAxes: [{
                                gridLines: {
                                    drawOnChartArea: false
                                },
                                ticks: {
                                    stepSize: {{ stepSizeY }}
                                }
                            }]
                    },
                    legend: {display: false},
                    title: {
                        display: true,
                        text: "Daily messages over time"
                    }
                }
            })
    </script>   
</body>

</html>

